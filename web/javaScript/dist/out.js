(()=>{var h=class{fetch_festival_api(s,t){return fetch("http://docketu.iutnc.univ-lorraine.fr:11110"+s,t).then(e=>e.ok?e.json():Promise.reject(new Error(e.statusText))).catch(e=>{console.log(e)})}},o=new h;var u=class{render_shows(s){let t=document.getElementsByClassName("article-list")[0];if(!t){console.error("Le conteneur des spectacles est introuvable.");return}if(!Array.isArray(s.shows)){console.error("Les spectacles ne sont pas au format d'un tableau.");return}t.innerHTML="",s.shows.forEach(e=>{let n=document.createElement("article"),i=[];e.artists.forEach(_=>{i.push(_.name)});let d=i.join(" - "),c=new Date(e.date+" "+e.time),l={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};e.date=c.toLocaleDateString("fr-FR",l),e.date=e.date.charAt(0).toUpperCase()+e.date.slice(1),n.innerHTML=`
            <div class="article-content">
                <h3>${e.title}</h3>
                <p>${e.date}</p>
                <p>${d}</p>
            </div>
            <img src="${e.images[0].path}">
            `,t.appendChild(n)})}render_spots(s){let t=document.getElementsByClassName("filtre")[0];if(!t){console.error("Le conteneur des lieux est introuvable.");return}t.innerHTML="";let e=document.createElement("li");e.innerHTML=`
        <a href="#">Tous les lieux</a>
        `,e.addEventListener("click",()=>{r.load_shows()}),t.appendChild(e),s.spots.forEach(n=>{let i=document.createElement("li");i.innerHTML=`
            <a href="#">${n.name}</a>
            `,i.addEventListener("click",()=>{r.load_shows_by_spot(n.name)}),t.appendChild(i)})}render_dates(s){let t=document.getElementsByClassName("filtre")[0];if(!t){console.error("Le conteneur des dates est introuvable.");return}t.innerHTML="";let e=document.createElement("li");e.innerHTML=`
        <a href="#">Tous les jours</a>
        `,e.addEventListener("click",()=>{r.load_shows()}),t.appendChild(e),s.dates.forEach(n=>{let i=n,d=new Date(n),c={weekday:"long",year:"numeric",month:"long",day:"numeric"};n=d.toLocaleDateString("fr-FR",c),n=n.charAt(0).toUpperCase()+n.slice(1);let l=document.createElement("li");l.innerHTML=`
            <a href="#">${n}</a>
            `,i=i.slice(0,10),l.addEventListener("click",()=>{r.load_shows_by_date(i)}),t.appendChild(l)})}render_thematics(s){let t=document.getElementsByClassName("filtre")[0];if(!t){console.error("Le conteneur des th\xE9matiques est introuvable.");return}t.innerHTML="";let e=document.createElement("li");e.innerHTML=`
        <a href="#">Tous les styles</a>
        `,e.addEventListener("click",()=>{r.load_shows()}),t.appendChild(e),s.thematics.forEach(n=>{let i=document.createElement("li");i.innerHTML=`
            <a href="#">${n}</a>
            `,i.addEventListener("click",()=>{r.load_shows_by_thematic(n)}),t.appendChild(i)})}},a=new u;var m=class{constructor(){this.loading=!1,this.initializeEventListeners(),this.spots=null,this.dates=null,this.thematics=null}initializeEventListeners(){let s=document.getElementById("lieux-filtre"),t=document.getElementById("date-filtre"),e=document.getElementById("style-filtre");s.addEventListener("click",()=>{this.loadLieuxData()}),t.addEventListener("click",()=>{this.loadDatesData()}),e.addEventListener("click",()=>{this.loadThematicsData()})}loadLieuxData(){this.spots===null?o.fetch_festival_api("/spots_evening").then(s=>{this.spots=s,a.render_spots(this.spots)}):a.render_spots(this.spots)}loadDatesData(){this.dates===null?o.fetch_festival_api("/dates_evening").then(s=>{this.dates=s,a.render_dates(this.dates)}):a.render_dates(this.dates)}loadThematicsData(){this.thematics===null?o.fetch_festival_api("/thematics_evening").then(s=>{this.thematics=s,a.render_thematics(this.thematics)}):a.render_thematics(this.thematics)}load_shows(){this.loading||(o.fetch_festival_api("/shows").then(s=>{a.render_shows(s),this.loading=!1}),this.loading=!0)}load_shows_by_thematic(s){this.loading||(o.fetch_festival_api("/shows?thematic="+s).then(t=>{a.render_shows(t),this.loading=!1}),this.loading=!0)}load_shows_by_date(s){this.loading||(o.fetch_festival_api("/shows?date="+s).then(t=>{a.render_shows(t),this.loading=!1}),this.loading=!0)}load_shows_by_spot(s){this.loading||(o.fetch_festival_api("/shows?lieu="+s).then(t=>{a.render_shows(t),this.loading=!1}),this.loading=!0)}},r=new m;document.addEventListener("DOMContentLoaded",()=>{r.load_shows()});})();
